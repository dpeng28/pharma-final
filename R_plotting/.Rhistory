xlab("Time - min")+
theme_bw()+
theme(text = element_text(size=20))
# plot different dose scheme
#####
diffDoseRaw = readMat("difdose.mat")
doseScheme = c("placeHold", "500mg", "700mg", "1500mg", "550mg", "200mg")
liverPlot = data.frame(time = NULL, amount = NULL, Dose_Amount = NULL)
for(myIndex in 2:6) {
tempLiver = data.frame(time = diffDoseRaw[1], amount = diffDoseRaw[[myIndex]][,3], Dose_Amount = doseScheme[myIndex])
liverPlot = rbind(liverPlot, tempLiver)
print(myIndex)
}
secondLiverPlot = liverPlot
liverPlot = rbind(liverPlot[liverPlot$Dose_Amount == "1500mg",],
liverPlot[liverPlot$Dose_Amount == "700mg",],
liverPlot[liverPlot$Dose_Amount == "550mg",],
liverPlot[liverPlot$Dose_Amount == "500mg",],
liverPlot[liverPlot$Dose_Amount == "200mg",])
liverPlot$Dose_Amount <- factor(liverPlot$Dose_Amount, levels = c("1500mg", "700mg", "550mg", "500mg", "200mg"))
liverPlot$miniTitle = "Metformin Amount in Liver Over Time"
# metforming liver plotting
ggplot(liverPlot, aes(t, amount, color = Dose_Amount)) +
geom_line(data = liverPlot, size = 1.2) +
ggtitle("Metformin Amount in Liver Over Time")+
ylab("Amount - mg")+
xlab("Time - hours")+
theme_bw()+
theme(text = element_text(size=20), legend.position = "none")
# metforming liver plotting
ggplot(liverPlot, aes(t, amount, color = Dose_Amount)) +
geom_line(data = liverPlot, size = 1.2) +
ggtitle("Metformin Amount in Liver Over Time")+
ylab("Amount - mg")+
xlab("Time - min")+
theme_bw()+
theme(text = element_text(size=20), legend.position = "none")
# plot periphery
bloodPlot = data.frame(time = NULL, amount = NULL, Dose_Amount = NULL)
for(myIndex in 2:6) {
temp = data.frame(time = diffDoseRaw[1], amount = diffDoseRaw[[myIndex]][,4], Dose_Amount = doseScheme[myIndex])
bloodPlot = rbind(bloodPlot, temp)
print(myIndex)
}
bloodPlot$Dose_Amount <- factor(bloodPlot$Dose_Amount, levels = c("1500mg", "700mg", "550mg", "500mg", "200mg"))
bloodPlot$miniTitle = "Metformin Amount in Blood Over Time"
ggplot(bloodPlot, aes(t, amount, color = Dose_Amount)) +
geom_line(data = bloodPlot, size = 1.2) +
ggtitle("Metformin Amount in Blood Over Time")+
ylab("Amount - mg")+
xlab("Time - hours")+
theme_bw()+
theme(text = element_text(size=20), legend.position = "none")
ggplot(bloodPlot, aes(t, amount, color = Dose_Amount)) +
geom_line(data = bloodPlot, size = 1.2) +
ggtitle("Metformin Amount in Blood Over Time")+
ylab("Amount - mg")+
xlab("Time - hours")+
theme_bw()+
theme(text = element_text(size=20), legend.position = c(0.8, 0.6))
ggplot(bloodPlot, aes(t, amount, color = Dose_Amount)) +
geom_line(data = bloodPlot, size = 1.2) +
ggtitle("Metformin Amount in Blood Over Time")+
ylab("Amount - mg")+
xlab("Time - min")+
theme_bw()+
theme(text = element_text(size=20), legend.position = c(0.8, 0.6))
# metforming liver plotting
ggplot(liverPlot, aes(t, amount, color = Dose_Amount)) +
geom_line(data = liverPlot, size = 1.2) +
ggtitle("Metformin Amount in Liver Over Time")+
ylab("Amount - mg")+
xlab("Time - min")+
theme_bw()+
theme(text = element_text(size=20), legend.position = c(0.8, 0.6))
# plot glucoseConc without diet
gluPlot = data.frame(time = NULL, amount = NULL, Dose_Amount = NULL)
for(myIndex in 2:6) {
temp = data.frame(time = diffDoseRaw[1], amount = diffDoseRaw[[myIndex]][,5], Dose_Amount = doseScheme[myIndex])
gluPlot = rbind(gluPlot, temp)
print(myIndex)
}
gluPlot$Dose_Amount <- factor(gluPlot$Dose_Amount, levels = c("1500mg", "700mg", "550mg", "500mg", "200mg"))
gluPlot1 = gluPlot
gluPlot1$miniTitle = "Blood Glucose Concentration[No Food Intake]"
ggplot(gluPlot, aes(t, amount, color = Dose_Amount)) +
geom_line(data = gluPlot, size = 1.2) +
ggtitle("Blood Glucose Concentration[No Food Intake]")+
ylab("Amount - mg/dL")+
xlab("Time - hours")+
theme_bw()+
theme(text = element_text(size=20), legend.position = "none")
ggplot(gluPlot, aes(t, amount, color = Dose_Amount)) +
geom_line(data = gluPlot, size = 1.2) +
ggtitle("Blood Glucose Concentration[No Food Intake]")+
ylab("Amount - mg/dL")+
xlab("Time - hours")+
theme_bw()+
theme(text = element_text(size=20), legend.position = c(0.8, 0.6))
ggplot(gluPlot, aes(t, amount, color = Dose_Amount)) +
geom_line(data = gluPlot, size = 1.2) +
ggtitle("Blood Glucose Concentration[No Food Intake]")+
ylab("Amount - mg/dL")+
xlab("Time - hours")+
theme_bw()+
theme(text = element_text(size=20), legend.position = c(0.8, 0.9))
ggplot(gluPlot, aes(t, amount, color = Dose_Amount)) +
geom_line(data = gluPlot, size = 1.2) +
ggtitle("Blood Glucose Concentration[No Food Intake]")+
ylab("Amount - mg/dL")+
xlab("Time - hours")+
theme_bw()+
theme(text = element_text(size=20), legend.position = c(0.8, 0.7))
ggplot(gluPlot, aes(t, amount, color = Dose_Amount)) +
geom_line(data = gluPlot, size = 1.2) +
ggtitle("Blood Glucose Concentration[No Food Intake]")+
ylab("Amount - mg/dL")+
xlab("Time - hours")+
theme_bw()+
theme(text = element_text(size=20), legend.position = c(0.8, 0.8))
ggplot(gluPlot, aes(t, amount, color = Dose_Amount)) +
geom_line(data = gluPlot, size = 1.2) +
ggtitle("Blood Glucose Concentration[No Food Intake]")+
ylab("Amount - mg/dL")+
xlab("Time - hours")+
theme_bw()+
theme(text = element_text(size=20), legend.position = c(0.8, 0.7.9))
ggplot(gluPlot, aes(t, amount, color = Dose_Amount)) +
geom_line(data = gluPlot, size = 1.2) +
ggtitle("Blood Glucose Concentration[No Food Intake]")+
ylab("Amount - mg/dL")+
xlab("Time - hours")+
theme_bw()+
theme(text = element_text(size=20), legend.position = c(0.8, 0.79))
ggplot(gluPlot, aes(t, amount, color = Dose_Amount)) +
geom_line(data = gluPlot, size = 1.2) +
ggtitle("Blood Glucose Concentration[No Food Intake]")+
ylab("Amount - mg/dL")+
xlab("Time - hours")+
theme_bw()+
theme(text = element_text(size=20), legend.position = c(0.8, 0.75))
ggplot(gluPlot, aes(t, amount, color = Dose_Amount)) +
geom_line(data = gluPlot, size = 1.2) +
ggtitle("Blood Glucose Concentration[No Food Intake]")+
ylab("Amount - mg/dL")+
xlab("Time - hours")+
theme_bw()+
theme(text = element_text(size=20), legend.position = c(0.7.5, 0.75))
ggplot(gluPlot, aes(t, amount, color = Dose_Amount)) +
geom_line(data = gluPlot, size = 1.2) +
ggtitle("Blood Glucose Concentration[No Food Intake]")+
ylab("Amount - mg/dL")+
xlab("Time - hours")+
theme_bw()+
theme(text = element_text(size=20), legend.position = c(0.75, 0.75))
ggplot(gluPlot, aes(t, amount, color = Dose_Amount)) +
geom_line(data = gluPlot, size = 1.2) +
ggtitle("Blood Glucose Concentration[No Food Intake]")+
ylab("Amount - mg/dL")+
xlab("Time - min")+
theme_bw()+
theme(text = element_text(size=20), legend.position = c(0.75, 0.75))
# plot glucoseConc With diet
gluPlot = data.frame(time = NULL, amount = NULL, Dose_Amount = NULL)
for(myIndex in 2:6) {
temp = data.frame(time = diffDoseRaw[1], amount = diffDoseRaw[[myIndex]][,6], Dose_Amount = doseScheme[myIndex])
gluPlot = rbind(gluPlot, temp)
print(myIndex)
}
gluPlot$Dose_Amount <- factor(gluPlot$Dose_Amount, levels = c("1500mg", "700mg", "550mg", "500mg", "200mg"))
gluPlot$miniTitle = "Blood Glucose Concentration[Food Intake]"
ggplot(gluPlot, aes(t, amount, color = Dose_Amount)) +
geom_line(data = gluPlot, size = 1.2) +
ggtitle("Blood Glucose Concentration[Food Intake]")+
ylab("Amount - mg/dL")+
xlab("Time - hours")+
theme_bw()+
theme(text = element_text(size=20), legend.position = c(0.75, 0.75))
ggplot(gluPlot, aes(t, amount, color = Dose_Amount)) +
geom_line(data = gluPlot, size = 1.2) +
ggtitle("Blood Glucose Concentration[Food Intake]")+
ylab("Amount - mg/dL")+
xlab("Time - min")+
theme_bw()+
theme(text = element_text(size=20), legend.position = c(0.75, 0.75))
# plot multidose
metConcMD = readMat("multidose(5).mat")
metConcType = c("GI_lumen", "GI_wall", "liver", "periphery", "blood_woDiet", "glucose_wDiet")
concPlotMDDf = data.frame(time = NULL, conc = NULL, compartment = NULL)
concMatrix = metConcMD$TotalDo
for(i in 1:4) {
tempDf = data.frame(time = metConcMD$To1, conc = concMatrix[, i], compartment = metConcType[i])
concPlotMDDf = rbind(concPlotMDDf, tempDf)
}
glucoseNoDietMD = data.frame(time = metConcMD$To1, yaxis = concMatrix[, 5])
glucoseDietMD = data.frame(time = metConcMD$To1, yaxis = concMatrix[, 6])
# metformin GI lumin
ggplot(concPlotMDDf[concPlotMDDf$compartment == "GI_lumen", ], aes(time, conc)) +
geom_line(size = 1.2) +
ggtitle("Metformin in GI Lumen")+
ylab("Amount - mg")+
xlab("Time - hours")+
theme_bw()+
theme(text = element_text(size=18))
# metformin GI lumin
ggplot(concPlotMDDf[concPlotMDDf$compartment == "GI_lumen", ], aes(time, conc)) +
geom_line(size = 1.2) +
ggtitle("Metformin in GI Lumen")+
ylab("Amount - mg")+
xlab("Time - min")+
theme_bw()+
theme(text = element_text(size=18))
# metformin GI lumin
ggplot(concPlotMDDf[concPlotMDDf$compartment == "GI_lumen", ], aes(time, conc)) +
geom_line(size = 1.2) +
ggtitle("Metformin in GI Lumen")+
ylab("Amount - mg")+
xlab("Time - min \n\n\n")+
theme_bw()+
theme(text = element_text(size=18))
# metformin GI lumin
ggplot(concPlotMDDf[concPlotMDDf$compartment == "GI_lumen", ], aes(time, conc)) +
geom_line(size = 1.2) +
ggtitle("Metformin in GI Lumen")+
ylab("Amount - mg  \n\n\n")+
xlab("Time - min")+
theme_bw()+
theme(text = element_text(size=18))
# metformin GI lumin
ggplot(concPlotMDDf[concPlotMDDf$compartment == "GI_lumen", ], aes(time, conc)) +
geom_line(size = 1.2) +
ggtitle("Metformin in GI Lumen")+
ylab("  \n\n\nAmount - mg")+
xlab("Time - min")+
theme_bw()+
theme(text = element_text(size=18))
# metformin GI lumin
ggplot(concPlotMDDf[concPlotMDDf$compartment == "GI_lumen", ], aes(time, conc)) +
geom_line(size = 1.2) +
ggtitle("Metformin in GI Lumen")+
ylab("Amount - mg")+
xlab("Time - min")+
theme_bw()+
theme(text = element_text(size=18))
# metformin GI lumin
ggplot(concPlotMDDf[concPlotMDDf$compartment == "GI_lumen", ], aes(time, conc)) +
geom_line(size = 1.2) +
ggtitle("Metformin in GI Lumen")+
ylab("Amount - mg")+
xlab("Time - min")+
theme_bw()+
theme(text = element_text(size=16))
# metformin GI lumin
ggplot(concPlotMDDf[concPlotMDDf$compartment == "GI_lumen", ], aes(time, conc)) +
geom_line(size = 1.2) +
ggtitle("Metformin in GI Lumen")+
ylab("Amount - mg")+
xlab("Time - min")+
theme_bw()+
theme(text = element_text(size=18))
# metformin GI lumin
ggplot(concPlotMDDf[concPlotMDDf$compartment == "GI_lumen", ], aes(time, conc)) +
geom_line(size = 1.2) +
ggtitle("Metformin in GI Lumen")+
ylab("Amount - mg")+
xlab("Time - min")+
theme_bw()+
theme(text = element_text(size=18), axis.text.x = element_text(angle = 45, size = 15))
# metformin GI lumin
ggplot(concPlotMDDf[concPlotMDDf$compartment == "GI_lumen", ], aes(time, conc)) +
geom_line(size = 1.2) +
ggtitle("Metformin in GI Lumen")+
ylab("Amount - mg")+
xlab("Time - min")+
theme_bw()+
theme(text = element_text(size=18), axis.text.x = element_text(size = 15))
# metformin GI lumin
ggplot(concPlotMDDf[concPlotMDDf$compartment == "GI_lumen", ], aes(time, conc)) +
geom_line(size = 1.2) +
ggtitle("Metformin in GI Lumen")+
ylab("Amount - mg")+
xlab("Time - min")+
theme_bw()+
theme(text = element_text(size=18), axis.ticks = element_text(size = 15))
# metformin GI lumin
ggplot(concPlotMDDf[concPlotMDDf$compartment == "GI_lumen", ], aes(time, conc)) +
geom_line(size = 1.2) +
ggtitle("Metformin in GI Lumen")+
ylab("Amount - mg")+
xlab("Time - min")+
theme_bw()+
theme(text = element_text(size=18), axis.text.x = element_text(size = 15))
# metformin GI lumin
ggplot(concPlotMDDf[concPlotMDDf$compartment == "GI_lumen", ], aes(time, conc)) +
geom_line(size = 1.2) +
ggtitle("Metformin in GI Lumen")+
ylab("Amount - mg")+
xlab("Time - min")+
theme_bw()+
theme(axis.title = element_text(size=18), axis.text.x = element_text(size = 15))
# metformin GI lumin
ggplot(concPlotMDDf[concPlotMDDf$compartment == "GI_lumen", ], aes(time, conc)) +
geom_line(size = 1.2) +
ggtitle("Metformin in GI Lumen")+
ylab("Amount - mg")+
xlab("Time - min")+
ylim(0, 1000)+
theme_bw()+
theme(text = element_text(size=18))
# metformin GI lumin
ggplot(concPlotMDDf[concPlotMDDf$compartment == "GI_lumen", ], aes(time, conc)) +
geom_line(size = 1.2) +
ggtitle("Metformin in GI Lumen")+
ylab("Amount - mg")+
xlab("Time - min")+
xlim(0, 1000)+
theme_bw()+
theme(text = element_text(size=18))
# metformin GI lumin
ggplot(concPlotMDDf[concPlotMDDf$compartment == "GI_lumen", ], aes(time, conc)) +
geom_line(size = 1.2) +
ggtitle("Metformin in GI Lumen")+
ylab("Amount - mg")+
xlab("Time - min")+
xlim(0, 1200)+
theme_bw()+
theme(text = element_text(size=18))
# metformin GI lumin
ggplot(concPlotMDDf[concPlotMDDf$compartment == "GI_lumen", ], aes(time, conc)) +
geom_line(size = 1.2) +
ggtitle("Metformin in GI Lumen")+
ylab("Amount - mg")+
xlab("Time - min")+
xlim(0, 1100)+
theme_bw()+
theme(text = element_text(size=18))
# metformin blood
ggplot(concPlotMDDf[concPlotMDDf$compartment == "periphery", ], aes(time, conc)) +
geom_line(size = 1.2) +
ggtitle("Metformin in Periphery")+
ylab("Amount - mg")+
xlab("Time - min")+
xlim(0, 1100)+
theme_bw()+
theme(text = element_text(size=18))
# glucose no diet plotting
ggplot(glucoseNoDietMD, aes(time, yaxis)) +
geom_line(size = 1.2) +
ggtitle("Glucose Concentration without Glucose Input")+
ylab("Concentration - mg/dL")+
xlab("Time - min")+
xlim(0, 1100)+
theme_bw()+
theme(text = element_text(size=20))
# glucose with diet plotting
ggplot(glucoseDietMD, aes(time, yaxis)) +
geom_line(data = glucoseDietMD, size = 1.2) +
ggtitle("Glucose Concentration with Glucose Input")+
ylab("Concentration - mg/dL")+
xlab("Time - min")+
theme_bw()+
theme(text = element_text(size=20))
# glucose with diet plotting
ggplot(glucoseDietMD, aes(time, yaxis)) +
geom_line(data = glucoseDietMD, size = 1.2) +
ggtitle("Glucose Concentration with Glucose Input")+
ylab("Concentration - mg/dL")+
xlab("Time - min")+
xlim(0, 1100)+
theme_bw()+
theme(text = element_text(size=20))
shiny::runApp('~/Github/pharma-final/GUI_final')
library(shiny)
library(shinydashboard)
library(R.matlab)
library(ggplot2)
library(reshape)
library(plotly)
library(matlabr)
library(slickR)
runApp('~/Github/pharma-final/GUI_final')
# plot single dose
######
metConc = readMat("../GUI_final/Data/dosedietsingle.mat")
# glucose_change == glucose without diet
# blood glucose == glucose with diet
metConcType = c("GI_lumen", "GI_wall", "liver", "periphery", "blood_woDiet", "glucose_wDiet")
concPlotDf = data.frame(time = NULL, conc = NULL, compartment = NULL)
concMatrix = metConc$y
for(i in 1:4) {
tempDf = data.frame(time = metConc$t, conc = concMatrix[, i], compartment = metConcType[i])
concPlotDf = rbind(concPlotDf, tempDf)
}
glucoseNoDiet = data.frame(time = metConc$t, yaxis = concMatrix[, 5])
glucoseDiet = data.frame(time = metConc$t, yaxis = concMatrix[, 6])
# metforming plotting
ggplot(concPlotDf, aes(time, conc, color = compartment)) +
geom_line(data = concPlotDf, size = 1.2) +
ggtitle("Metformin Amount Over Time")+
ylab("Amount - mg")+
xlab("Time - min")+
theme_bw()+
theme(text = element_text(size=20), legend.position=c(.8, .6))
# focused in
# metforming plotting
ggplot(concPlotDf, aes(time, conc, color = compartment)) +
geom_line(data = concPlotDf, size = 1.2) +
ggtitle("Metformin Amount Over Time")+
ylab("Amount - mg")+
xlab("Time - min")+
ylim(c(0, 10))+
theme_bw()+
theme(text = element_text(size=20), legend.position=c(.8, .6))
# focused in
# metforming plotting
ggplot(concPlotDf, aes(time, conc, color = compartment)) +
geom_line(data = concPlotDf, size = 1.2) +
ggtitle("Metformin Amount Over Time")+
ylab("Amount - mg")+
xlab("Time - min")+
ylim(c(0, 15))+
theme_bw()+
theme(text = element_text(size=20), legend.position=c(.8, .6))
runApp
runApp()
# focused in
# metforming plotting
ggplot(concPlotDf, aes(time, conc, color = compartment)) +
geom_line(data = concPlotDf, size = 1.2) +
ggtitle("Metformin Amount Over Time")+
ylab("Amount - mg")+
xlab("Time - min")+
ylim(c(0, 15))+
theme_bw()+
theme(text = element_text(size=20), legend.position=c(.8, .6))
# metforming plotting
ggplot(concPlotDf, aes(time, conc, color = compartment)) +
geom_line(data = concPlotDf, size = 1.2) +
ggtitle("Metformin Amount Over Time")+
ylab("Amount - mg")+
xlab("Time - min")+
theme_bw()+
theme(text = element_text(size=20), legend.position=c(.8, .6))
# focused in
# metforming plotting
ggplot(concPlotDf, aes(time, conc, color = compartment)) +
geom_line(data = concPlotDf, size = 1.2) +
ggtitle("Metformin Amount Over Time-Zoomed In")+
ylab("Amount - mg")+
xlab("Time - min")+
ylim(c(0, 15))+
theme_bw()+
theme(text = element_text(size=20), legend.position=c(.8, .6))
glucoseDiet$Diet = "With Food"
glucoseNoDiet$Diet = "No Food"
glcosePlot = rbind(glucoseDiet, glucoseNoDiet)
ggplot(glcosePlot, aes(time, yaxis, color = Diet)) +
geom_line(data = glcosePlot, size = 1.2) +
ggtitle("Glucose Concentration")+
ylab("Concentration - mg/dL")+
xlab("Time - min")+
theme_bw()+
theme(text = element_text(size=20))
glucoseNoDiet$Diet_Status = "No Food"
glucoseDiet$Diet_Status = "With Food"
glucoseNoDiet$Diet_Status = "No Food"
glcosePlot = rbind(glucoseDiet, glucoseNoDiet)
ggplot(glcosePlot, aes(time, yaxis, color = Diet_Status)) +
geom_line(data = glcosePlot, size = 1.2) +
ggtitle("Glucose Concentration")+
ylab("Concentration - mg/dL")+
xlab("Time - min")+
theme_bw()+
theme(text = element_text(size=20))
ggplot(glcosePlot, aes(time, yaxis, color = Diet_Status)) +
geom_line(data = glcosePlot, size = 1.2) +
ggtitle("Glucose Concentration")+
ylab("Concentration - mg/dL")+
xlab("Time - min")+
theme_bw()+
theme(text = element_text(size=20), legend.position=c(.8, .6))
ggplot(plotDf, aes(t, balance)) +
geom_line(data = plotDf, size = 1.2) +
ggtitle("Mass Balance of Metformin")+
ylab("Concentration - mg")+
xlab("Time - min")+
scale_y_continuous(label=scientific_10)+
theme_bw()+
theme(text = element_text(size=20))
# plot mass balance
#######
balance = readMat("balance.mat")
plotDf = data.frame(time = as.vector(balance[1]), conc = balance[2])
scientific_10 <- function(x) {
parse(text=gsub("e", " %*% 10^", scales::scientific_format()(x)))
}
ggplot(plotDf, aes(t, balance)) +
geom_line(data = plotDf, size = 1.2) +
ggtitle("Mass Balance of Metformin")+
ylab("Concentration - mg")+
xlab("Time - min")+
scale_y_continuous(label=scientific_10)+
theme_bw()+
theme(text = element_text(size=20))
ggplot(plotDf, aes(t, balance)) +
geom_line(data = plotDf, size = 1.2) +
ggtitle("Mass Balance of Metformin")+
ylab("Amount - mg")+
xlab("Time - min")+
scale_y_continuous(label=scientific_10)+
theme_bw()+
theme(text = element_text(size=20))
