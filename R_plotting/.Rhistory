ylab("Amount - mg")+
xlab("Time - min \n\n\n")+
theme_bw()+
theme(text = element_text(size=18))
# metformin GI lumin
ggplot(concPlotMDDf[concPlotMDDf$compartment == "GI_lumen", ], aes(time, conc)) +
geom_line(size = 1.2) +
ggtitle("Metformin in GI Lumen")+
ylab("Amount - mg  \n\n\n")+
xlab("Time - min")+
theme_bw()+
theme(text = element_text(size=18))
# metformin GI lumin
ggplot(concPlotMDDf[concPlotMDDf$compartment == "GI_lumen", ], aes(time, conc)) +
geom_line(size = 1.2) +
ggtitle("Metformin in GI Lumen")+
ylab("  \n\n\nAmount - mg")+
xlab("Time - min")+
theme_bw()+
theme(text = element_text(size=18))
# metformin GI lumin
ggplot(concPlotMDDf[concPlotMDDf$compartment == "GI_lumen", ], aes(time, conc)) +
geom_line(size = 1.2) +
ggtitle("Metformin in GI Lumen")+
ylab("Amount - mg")+
xlab("Time - min")+
theme_bw()+
theme(text = element_text(size=18))
# metformin GI lumin
ggplot(concPlotMDDf[concPlotMDDf$compartment == "GI_lumen", ], aes(time, conc)) +
geom_line(size = 1.2) +
ggtitle("Metformin in GI Lumen")+
ylab("Amount - mg")+
xlab("Time - min")+
theme_bw()+
theme(text = element_text(size=16))
# metformin GI lumin
ggplot(concPlotMDDf[concPlotMDDf$compartment == "GI_lumen", ], aes(time, conc)) +
geom_line(size = 1.2) +
ggtitle("Metformin in GI Lumen")+
ylab("Amount - mg")+
xlab("Time - min")+
theme_bw()+
theme(text = element_text(size=18))
# metformin GI lumin
ggplot(concPlotMDDf[concPlotMDDf$compartment == "GI_lumen", ], aes(time, conc)) +
geom_line(size = 1.2) +
ggtitle("Metformin in GI Lumen")+
ylab("Amount - mg")+
xlab("Time - min")+
theme_bw()+
theme(text = element_text(size=18), axis.text.x = element_text(angle = 45, size = 15))
# metformin GI lumin
ggplot(concPlotMDDf[concPlotMDDf$compartment == "GI_lumen", ], aes(time, conc)) +
geom_line(size = 1.2) +
ggtitle("Metformin in GI Lumen")+
ylab("Amount - mg")+
xlab("Time - min")+
theme_bw()+
theme(text = element_text(size=18), axis.text.x = element_text(size = 15))
# metformin GI lumin
ggplot(concPlotMDDf[concPlotMDDf$compartment == "GI_lumen", ], aes(time, conc)) +
geom_line(size = 1.2) +
ggtitle("Metformin in GI Lumen")+
ylab("Amount - mg")+
xlab("Time - min")+
theme_bw()+
theme(text = element_text(size=18), axis.ticks = element_text(size = 15))
# metformin GI lumin
ggplot(concPlotMDDf[concPlotMDDf$compartment == "GI_lumen", ], aes(time, conc)) +
geom_line(size = 1.2) +
ggtitle("Metformin in GI Lumen")+
ylab("Amount - mg")+
xlab("Time - min")+
theme_bw()+
theme(text = element_text(size=18), axis.text.x = element_text(size = 15))
# metformin GI lumin
ggplot(concPlotMDDf[concPlotMDDf$compartment == "GI_lumen", ], aes(time, conc)) +
geom_line(size = 1.2) +
ggtitle("Metformin in GI Lumen")+
ylab("Amount - mg")+
xlab("Time - min")+
theme_bw()+
theme(axis.title = element_text(size=18), axis.text.x = element_text(size = 15))
# metformin GI lumin
ggplot(concPlotMDDf[concPlotMDDf$compartment == "GI_lumen", ], aes(time, conc)) +
geom_line(size = 1.2) +
ggtitle("Metformin in GI Lumen")+
ylab("Amount - mg")+
xlab("Time - min")+
ylim(0, 1000)+
theme_bw()+
theme(text = element_text(size=18))
# metformin GI lumin
ggplot(concPlotMDDf[concPlotMDDf$compartment == "GI_lumen", ], aes(time, conc)) +
geom_line(size = 1.2) +
ggtitle("Metformin in GI Lumen")+
ylab("Amount - mg")+
xlab("Time - min")+
xlim(0, 1000)+
theme_bw()+
theme(text = element_text(size=18))
# metformin GI lumin
ggplot(concPlotMDDf[concPlotMDDf$compartment == "GI_lumen", ], aes(time, conc)) +
geom_line(size = 1.2) +
ggtitle("Metformin in GI Lumen")+
ylab("Amount - mg")+
xlab("Time - min")+
xlim(0, 1200)+
theme_bw()+
theme(text = element_text(size=18))
# metformin GI lumin
ggplot(concPlotMDDf[concPlotMDDf$compartment == "GI_lumen", ], aes(time, conc)) +
geom_line(size = 1.2) +
ggtitle("Metformin in GI Lumen")+
ylab("Amount - mg")+
xlab("Time - min")+
xlim(0, 1100)+
theme_bw()+
theme(text = element_text(size=18))
# metformin blood
ggplot(concPlotMDDf[concPlotMDDf$compartment == "periphery", ], aes(time, conc)) +
geom_line(size = 1.2) +
ggtitle("Metformin in Periphery")+
ylab("Amount - mg")+
xlab("Time - min")+
xlim(0, 1100)+
theme_bw()+
theme(text = element_text(size=18))
# glucose no diet plotting
ggplot(glucoseNoDietMD, aes(time, yaxis)) +
geom_line(size = 1.2) +
ggtitle("Glucose Concentration without Glucose Input")+
ylab("Concentration - mg/dL")+
xlab("Time - min")+
xlim(0, 1100)+
theme_bw()+
theme(text = element_text(size=20))
# glucose with diet plotting
ggplot(glucoseDietMD, aes(time, yaxis)) +
geom_line(data = glucoseDietMD, size = 1.2) +
ggtitle("Glucose Concentration with Glucose Input")+
ylab("Concentration - mg/dL")+
xlab("Time - min")+
theme_bw()+
theme(text = element_text(size=20))
# glucose with diet plotting
ggplot(glucoseDietMD, aes(time, yaxis)) +
geom_line(data = glucoseDietMD, size = 1.2) +
ggtitle("Glucose Concentration with Glucose Input")+
ylab("Concentration - mg/dL")+
xlab("Time - min")+
xlim(0, 1100)+
theme_bw()+
theme(text = element_text(size=20))
shiny::runApp('~/Github/pharma-final/GUI_final')
library(shiny)
library(shinydashboard)
library(R.matlab)
library(ggplot2)
library(reshape)
library(plotly)
library(matlabr)
library(slickR)
runApp('~/Github/pharma-final/GUI_final')
# plot single dose
######
metConc = readMat("../GUI_final/Data/dosedietsingle.mat")
# glucose_change == glucose without diet
# blood glucose == glucose with diet
metConcType = c("GI_lumen", "GI_wall", "liver", "periphery", "blood_woDiet", "glucose_wDiet")
concPlotDf = data.frame(time = NULL, conc = NULL, compartment = NULL)
concMatrix = metConc$y
for(i in 1:4) {
tempDf = data.frame(time = metConc$t, conc = concMatrix[, i], compartment = metConcType[i])
concPlotDf = rbind(concPlotDf, tempDf)
}
glucoseNoDiet = data.frame(time = metConc$t, yaxis = concMatrix[, 5])
glucoseDiet = data.frame(time = metConc$t, yaxis = concMatrix[, 6])
# metforming plotting
ggplot(concPlotDf, aes(time, conc, color = compartment)) +
geom_line(data = concPlotDf, size = 1.2) +
ggtitle("Metformin Amount Over Time")+
ylab("Amount - mg")+
xlab("Time - min")+
theme_bw()+
theme(text = element_text(size=20), legend.position=c(.8, .6))
# focused in
# metforming plotting
ggplot(concPlotDf, aes(time, conc, color = compartment)) +
geom_line(data = concPlotDf, size = 1.2) +
ggtitle("Metformin Amount Over Time")+
ylab("Amount - mg")+
xlab("Time - min")+
ylim(c(0, 10))+
theme_bw()+
theme(text = element_text(size=20), legend.position=c(.8, .6))
# focused in
# metforming plotting
ggplot(concPlotDf, aes(time, conc, color = compartment)) +
geom_line(data = concPlotDf, size = 1.2) +
ggtitle("Metformin Amount Over Time")+
ylab("Amount - mg")+
xlab("Time - min")+
ylim(c(0, 15))+
theme_bw()+
theme(text = element_text(size=20), legend.position=c(.8, .6))
runApp
runApp()
# focused in
# metforming plotting
ggplot(concPlotDf, aes(time, conc, color = compartment)) +
geom_line(data = concPlotDf, size = 1.2) +
ggtitle("Metformin Amount Over Time")+
ylab("Amount - mg")+
xlab("Time - min")+
ylim(c(0, 15))+
theme_bw()+
theme(text = element_text(size=20), legend.position=c(.8, .6))
# metforming plotting
ggplot(concPlotDf, aes(time, conc, color = compartment)) +
geom_line(data = concPlotDf, size = 1.2) +
ggtitle("Metformin Amount Over Time")+
ylab("Amount - mg")+
xlab("Time - min")+
theme_bw()+
theme(text = element_text(size=20), legend.position=c(.8, .6))
# focused in
# metforming plotting
ggplot(concPlotDf, aes(time, conc, color = compartment)) +
geom_line(data = concPlotDf, size = 1.2) +
ggtitle("Metformin Amount Over Time-Zoomed In")+
ylab("Amount - mg")+
xlab("Time - min")+
ylim(c(0, 15))+
theme_bw()+
theme(text = element_text(size=20), legend.position=c(.8, .6))
glucoseDiet$Diet = "With Food"
glucoseNoDiet$Diet = "No Food"
glcosePlot = rbind(glucoseDiet, glucoseNoDiet)
ggplot(glcosePlot, aes(time, yaxis, color = Diet)) +
geom_line(data = glcosePlot, size = 1.2) +
ggtitle("Glucose Concentration")+
ylab("Concentration - mg/dL")+
xlab("Time - min")+
theme_bw()+
theme(text = element_text(size=20))
glucoseNoDiet$Diet_Status = "No Food"
glucoseDiet$Diet_Status = "With Food"
glucoseNoDiet$Diet_Status = "No Food"
glcosePlot = rbind(glucoseDiet, glucoseNoDiet)
ggplot(glcosePlot, aes(time, yaxis, color = Diet_Status)) +
geom_line(data = glcosePlot, size = 1.2) +
ggtitle("Glucose Concentration")+
ylab("Concentration - mg/dL")+
xlab("Time - min")+
theme_bw()+
theme(text = element_text(size=20))
ggplot(glcosePlot, aes(time, yaxis, color = Diet_Status)) +
geom_line(data = glcosePlot, size = 1.2) +
ggtitle("Glucose Concentration")+
ylab("Concentration - mg/dL")+
xlab("Time - min")+
theme_bw()+
theme(text = element_text(size=20), legend.position=c(.8, .6))
ggplot(plotDf, aes(t, balance)) +
geom_line(data = plotDf, size = 1.2) +
ggtitle("Mass Balance of Metformin")+
ylab("Concentration - mg")+
xlab("Time - min")+
scale_y_continuous(label=scientific_10)+
theme_bw()+
theme(text = element_text(size=20))
# plot mass balance
#######
balance = readMat("balance.mat")
plotDf = data.frame(time = as.vector(balance[1]), conc = balance[2])
scientific_10 <- function(x) {
parse(text=gsub("e", " %*% 10^", scales::scientific_format()(x)))
}
ggplot(plotDf, aes(t, balance)) +
geom_line(data = plotDf, size = 1.2) +
ggtitle("Mass Balance of Metformin")+
ylab("Concentration - mg")+
xlab("Time - min")+
scale_y_continuous(label=scientific_10)+
theme_bw()+
theme(text = element_text(size=20))
ggplot(plotDf, aes(t, balance)) +
geom_line(data = plotDf, size = 1.2) +
ggtitle("Mass Balance of Metformin")+
ylab("Amount - mg")+
xlab("Time - min")+
scale_y_continuous(label=scientific_10)+
theme_bw()+
theme(text = element_text(size=20))
library(matlabr)
library(R.matlab)
library(ggplot2)
sensYoung = read.table("../GUI_final/Data/young_sens.txt")
colnames(sensYoung) = c('kg0', 'kgg', 'kgl', 'klp', 'kpl', 'kpg', 'kp0', 'kin', 'dose')
rownames(sensYoung) = c('AUC', 'Ctrough_drug', 'Ctrough_glucose')
melt_sensYoung = data.frame(parameters = NULL, target = NULL, value = NULL)
for(myParam in colnames(sensYoung)) {
for(myTarget in rownames(sensYoung)) {
tempDf = data.frame(parameters = myParam, target = myTarget, Normalized_Sensitivity = sensYoung[myTarget, myParam])
melt_sensYoung = rbind(melt_sensYoung, tempDf)
}
}
# load in the sensitivity data for older mid age population
sensMid = read.table("../GUI_final/Data/mid_sens.txt")
colnames(sensMid) = c('kg0', 'kgg', 'kgl', 'klp', 'kpl', 'kpg', 'kp0', 'kin', 'dose')
rownames(sensMid) = c('AUC', 'Ctrough_drug', 'Ctrough_glucose')
melt_sensMid = data.frame(parameters = NULL, target = NULL, value = NULL)
for(myParam in colnames(sensMid)) {
for(myTarget in rownames(sensMid)) {
tempDf = data.frame(parameters = myParam, target = myTarget, Normalized_Sensitivity = sensMid[myTarget, myParam])
melt_sensMid = rbind(melt_sensMid, tempDf)
}
}
# load in the sensitivity data for older mid age population
sensOld = read.table("../GUI_final/Data/old_sens.txt")
colnames(sensOld) = c('kg0', 'kgg', 'kgl', 'klp', 'kpl', 'kpg', 'kp0', 'kin', 'dose')
rownames(sensOld) = c('AUC', 'Ctrough_drug', 'Ctrough_glucose')
melt_sensOld = data.frame(parameters = NULL, target = NULL, value = NULL)
for(myParam in colnames(sensOld)) {
for(myTarget in rownames(sensOld)) {
tempDf = data.frame(parameters = myParam, target = myTarget, Normalized_Sensitivity = sensOld[myTarget, myParam])
melt_sensOld = rbind(melt_sensOld, tempDf)
}
}
plotSens <- function(meltedSensDf) {
mycol <- c("darkgreen", 'white', 'darkred')
p = ggplot(meltedSensDf, aes(parameters, target)) +
scale_fill_gradientn(colours = mycol)+
theme(text = element_text(size=20))+
xlab("Parameters") +
ylab("Targets") +
geom_tile(aes(fill = Normalized_Sensitivity))
# return
p
}
plotSens(melt_sensYoung)
sensYoung = read.table("../GUI_final/Data/young_sens.txt")
colnames(sensYoung) = c('kg0', 'kgg', 'kgl', 'klp', 'kpl', 'kpg', 'kp0', 'kin', 'dose')
rownames(sensYoung) = c('Drug AUC', 'Drug Ctrough', 'Glucose Ctrough')
melt_sensYoung = data.frame(parameters = NULL, target = NULL, value = NULL)
for(myParam in colnames(sensYoung)) {
for(myTarget in rownames(sensYoung)) {
tempDf = data.frame(parameters = myParam, target = myTarget, Normalized_Sensitivity = sensYoung[myTarget, myParam])
melt_sensYoung = rbind(melt_sensYoung, tempDf)
}
}
# load in the sensitivity data for older mid age population
sensMid = read.table("../GUI_final/Data/mid_sens.txt")
colnames(sensMid) = c('kg0', 'kgg', 'kgl', 'klp', 'kpl', 'kpg', 'kp0', 'kin', 'dose')
rownames(sensMid) = c('Drug AUC', 'Drug Ctrough', 'Glucose Ctrough')
melt_sensMid = data.frame(parameters = NULL, target = NULL, value = NULL)
for(myParam in colnames(sensMid)) {
for(myTarget in rownames(sensMid)) {
tempDf = data.frame(parameters = myParam, target = myTarget, Normalized_Sensitivity = sensMid[myTarget, myParam])
melt_sensMid = rbind(melt_sensMid, tempDf)
}
}
# load in the sensitivity data for older mid age population
sensOld = read.table("../GUI_final/Data/old_sens.txt")
colnames(sensOld) = c('kg0', 'kgg', 'kgl', 'klp', 'kpl', 'kpg', 'kp0', 'kin', 'dose')
rownames(sensOld) = c('Drug AUC', 'Drug Ctrough', 'Glucose Ctrough')
melt_sensOld = data.frame(parameters = NULL, target = NULL, value = NULL)
for(myParam in colnames(sensOld)) {
for(myTarget in rownames(sensOld)) {
tempDf = data.frame(parameters = myParam, target = myTarget, Normalized_Sensitivity = sensOld[myTarget, myParam])
melt_sensOld = rbind(melt_sensOld, tempDf)
}
}
plotSens(melt_sensYoung)
plotSens <- function(meltedSensDf) {
mycol <- c("darkgreen", 'white', 'darkred')
p = ggplot(meltedSensDf, aes(parameters, target)) +
scale_fill_gradientn(colours = mycol)+
theme(text = element_text(size=24))+
xlab("Parameters") +
ylab("Targets") +
geom_tile(aes(fill = Normalized_Sensitivity))
# return
p
}
plotSens(melt_sensYoung)
plotSens <- function(meltedSensDf) {
mycol <- c("darkgreen", 'white', 'darkred')
p = ggplot(meltedSensDf, aes(parameters, target)) +
labs(colour = "Normalized Sensitivity")+
scale_fill_gradientn(colours = mycol)+
theme(text = element_text(size=24))+
xlab("Parameters") +
ylab("Targets") +
geom_tile(aes(fill = Normalized_Sensitivity))
# return
p
}
plotSens(melt_sensYoung)
plotSens <- function(meltedSensDf) {
mycol <- c("darkgreen", 'white', 'darkred')
p = ggplot(meltedSensDf, aes(parameters, target)) +
labs(colour = "Normalized Sensitivity")+
scale_fill_gradientn(colours = mycol)+
theme(text = element_text(title = "Normalized Sensitivity", size=24))+
xlab("Parameters") +
ylab("Targets") +
geom_tile(aes(fill = Normalized_Sensitivity))
# return
p
}
plotSens(melt_sensYoung)
sensYoung = read.table("../GUI_final/Data/young_sens.txt")
colnames(sensYoung) = c('kg0', 'kgg', 'kgl', 'klp', 'kpl', 'kpg', 'kp0', 'kin', 'dose')
rownames(sensYoung) = c('Drug AUC', 'Drug Ctrough', 'Glucose Ctrough')
melt_sensYoung = data.frame(parameters = NULL, target = NULL, value = NULL)
for(myParam in colnames(sensYoung)) {
for(myTarget in rownames(sensYoung)) {
tempDf = data.frame(parameters = myParam, target = myTarget, norm_sens = sensYoung[myTarget, myParam])
melt_sensYoung = rbind(melt_sensYoung, tempDf)
}
}
# load in the sensitivity data for older mid age population
sensMid = read.table("../GUI_final/Data/mid_sens.txt")
colnames(sensMid) = c('kg0', 'kgg', 'kgl', 'klp', 'kpl', 'kpg', 'kp0', 'kin', 'dose')
rownames(sensMid) = c('Drug AUC', 'Drug Ctrough', 'Glucose Ctrough')
melt_sensMid = data.frame(parameters = NULL, target = NULL, value = NULL)
for(myParam in colnames(sensMid)) {
for(myTarget in rownames(sensMid)) {
tempDf = data.frame(parameters = myParam, target = myTarget, norm_sens = sensMid[myTarget, myParam])
melt_sensMid = rbind(melt_sensMid, tempDf)
}
}
# load in the sensitivity data for older mid age population
sensOld = read.table("../GUI_final/Data/old_sens.txt")
colnames(sensOld) = c('kg0', 'kgg', 'kgl', 'klp', 'kpl', 'kpg', 'kp0', 'kin', 'dose')
rownames(sensOld) = c('Drug AUC', 'Drug Ctrough', 'Glucose Ctrough')
melt_sensOld = data.frame(parameters = NULL, target = NULL, value = NULL)
for(myParam in colnames(sensOld)) {
for(myTarget in rownames(sensOld)) {
tempDf = data.frame(parameters = myParam, target = myTarget, norm_sens = sensOld[myTarget, myParam])
melt_sensOld = rbind(melt_sensOld, tempDf)
}
}
plotSens <- function(meltedSensDf) {
mycol <- c("darkgreen", 'white', 'darkred')
p = ggplot(meltedSensDf, aes(parameters, target)) +
scale_fill_gradientn(colours = mycol)+
theme(text = element_text(size=24))+
xlab("Parameters") +
ylab("Targets") +
geom_tile(aes(fill = norm_sens))
# return
p
}
plotSens(melt_sensYoung)
plotSens <- function(meltedSensDf) {
mycol <- c("darkgreen", 'white', 'darkred')
p = ggplot(meltedSensDf, aes(parameters, target)) +
scale_fill_gradientn(colours = mycol)+
labs(fill = "Dose (mg)")
theme(text = element_text(size=24))+
xlab("Parameters") +
ylab("Targets") +
geom_tile(aes(fill = norm_sens))
# return
p
}
plotSens(melt_sensYoung)
plotSens <- function(meltedSensDf) {
mycol <- c("darkgreen", 'white', 'darkred')
p = ggplot(meltedSensDf, aes(parameters, target)) +
scale_fill_gradientn(colours = mycol)+
labs(fill = "Dose (mg)")+
theme(text = element_text(size=24))+
xlab("Parameters") +
ylab("Targets") +
geom_tile(aes(fill = norm_sens))
# return
p
}
plotSens(melt_sensYoung)
plotSens <- function(meltedSensDf) {
mycol <- c("darkgreen", 'white', 'darkred')
p = ggplot(meltedSensDf, aes(parameters, target)) +
scale_fill_gradientn(colours = mycol)+
labs(fill = "Normalized Sensitivity")+
theme(text = element_text(size=24))+
xlab("Parameters") +
ylab("Targets") +
geom_tile(aes(fill = norm_sens))
# return
p
}
plotSens(melt_sensYoung)
plotSens <- function(meltedSensDf) {
mycol <- c("darkgreen", 'white', 'darkred')
p = ggplot(meltedSensDf, aes(parameters, target)) +
scale_fill_gradientn(colours = mycol)+
labs(fill = "Normalized \n Sensitivity")+
theme(text = element_text(size=24))+
xlab("Parameters") +
ylab("Targets") +
geom_tile(aes(fill = norm_sens))
# return
p
}
plotSens(melt_sensYoung)
plotSens(melt_sensMid)
plotSens(melt_sensOld)
